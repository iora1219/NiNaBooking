<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æˆ‘çš„é ç´„åŸå¸‚</title>

  <!-- Firebaseï¼ˆæ–°æ‰‹å‹å–„ç‰ˆï¼Œä¸ç”¨ importï¼‰ -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .slot {
      border: 1px solid #aaa;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      cursor: pointer;
    }
    .empty {
      background-color: #d4edda;
    }
    .full {
      background-color: #f8d7da;
      color: #555;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

<h2>ğŸ“… æˆ‘çš„é ç´„åŸå¸‚ï¼ˆç¤ºç¯„ï¼‰</h2>

<!-- æ™‚æ®µæ¸…å–® -->
<div class="slot empty" data-id="2025-03-10_09">3/10 09:00â€“10:00</div>
<div class="slot empty" data-id="2025-03-10_10">3/10 10:00â€“11:00</div>
<div class="slot empty" data-id="2025-03-10_11">3/10 11:00â€“12:00</div>

<script>
  /* === Firebase è¨­å®šï¼ˆä½ çš„å°ˆæ¡ˆï¼‰ === */
  const firebaseConfig = {
    apiKey: "AIzaSyDPUz-JfM4eowCS2sjq_bkUaOShrm8OFvc",
    authDomain: "booking-2868f.firebaseapp.com",
    projectId: "booking-2868f"
  };

  // å•Ÿå‹• Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  /* === åŸå¸‚é‚è¼¯ === */
  const slots = document.querySelectorAll(".slot");

  slots.forEach(slot => {
    const id = slot.dataset.id;

    // è®€å–è³‡æ–™åº«ï¼Œçœ‹é€™å€‹æ™‚æ®µæœ‰æ²’æœ‰äºº
    db.collection("bookings").doc(id).get().then(doc => {
      if (doc.exists) {
        slot.textContent += `ï¼ˆ${doc.data().name}ï¼‰`;
        slot.classList.remove("empty");
        slot.classList.add("full");
      }
    });

    // é»æ“Šé ç´„
    slot.addEventListener("click", () => {
      if (slot.classList.contains("full")) return;

      const name = prompt("è«‹è¼¸å…¥ä½ çš„åå­—");
      if (!name) return;

      db.collection("bookings").doc(id).set({
        name: name
      }).then(() => {
        slot.textContent += `ï¼ˆ${name}ï¼‰`;
        slot.classList.remove("empty");
        slot.classList.add("full");
      });
    });
  });
</script>

</body>
</html>
